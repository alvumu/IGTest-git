<ul class="list">
{% assign section      = include.section      | default: '' %}
{% assign contains     = include.contains     | default: '' %}
{% assign nav          = include.nav          | default: '' %}
{% assign termKind     = include.termKind     | default: '' %}
{% assign srcpath      = include.srcpath      | default: '' %}
{% assign excludeIndex = include.excludeIndex | default: true %}

{% assign pages = site.html_pages | concat: site.pages %}

{% assign pages = pages | where_exp:'p','p.url contains ".html"' %}

{% if srcpath != '' %}
  {% assign pages = pages | where_exp:'p','p.path contains srcpath' %}
{% endif %}

{% if section != '' %}
  {% assign pages = pages | where_exp:'p','p.url contains section' %}
{% endif %}

{% if contains != '' %}
  {% assign pages = pages | where_exp:'p','p.url contains contains' %}
{% endif %}

{% if nav != '' %}
  {% assign pages = pages | where:'navSection', nav %}
{% endif %}
{% if termKind != '' %}
  {% assign pages = pages | where:'termKind', termKind %}
{% endif %}

{% assign pages = pages | uniq | sort:'title' %}

{%- assign idxurl = '' -%}
{% if excludeIndex and section != '' %}
  {% assign idxurl = section | append:'index.html' %}
{% endif %}

{%- assign any = false -%}
{% for p in pages %}
  {% assign skip = false %}
  {% if excludeIndex and idxurl != '' and p.url == idxurl %}
    {% assign skip = true %}
  {% endif %}
  {% if excludeIndex and srcpath != '' and p.path contains '/index.md' %}
    {% assign skip = true %}
  {% endif %}

  {% unless skip %}
    {% assign title = p.title | default:p.name | default:p.url %}
    <li><a href="{{ p.url | relative_url }}">{{ title }}</a></li>
    {% assign any = true %}
  {% endunless %}
{% endfor %}

{% unless any %}
  <li><em>No entries found</em></li>
{% endunless %}
</ul>
